@echo off
cls
ECHO Welcome to the Windows 95 Zip loader. This will create a >=5mb zip file later used on the Dreamcast.
ECHO.
ECHO Warnings - These can be skipped. These mean that something may be missing but is unimportant (such as a PIF file)
ECHO.
ECHO ERRORS - These can't be skipped. These mean that important files (such as GDI.EXE or COMMAND.COM) are missing.
ECHO.
ECHO You must read the EULA first before starting installation. You can find the EULA on the Wiki for this program here:
ECHO https://github.com/SparrOSDeveloperTeam/Windows-95-Dreamcast/wiki/EULA
ECHO.
ECHO Press any key to Start the Setup
pause >nul
ECHO Cleaning Temporary Files (if any) [1/4]
ECHO.
DEL OUTPUT\MAKEFILE
DELTREE OUTPUT\.
DEL MISSING\*.DEL
ECHO.
ECHO Making Directories [2/4]
ECHO.
IF NOT EXIST .\MISSING MKDIR MISSING
MKDIR OUTPUT\WINDOWS
MKDIR OUTPUT\WINDOWS\DESKTOP
MKDIR OUTPUT\WINDOWS\FONTS
MKDIR OUTPUT\WINDOWS\IOS.LOG
MKDIR OUTPUT\WINDOWS\PIF
MKDIR OUTPUT\WINDOWS\RECENT
MKDIR OUTPUT\WINDOWS\SHELLICONCACHE
MKDIR OUTPUT\WINDOWS\START MENU
MKDIR OUTPUT\WINDOWS\START MENU\PROGRAMS
MKDIR OUTPUT\WINDOWS\START MENU\PROGRAMS\STARTUP
MKDIR OUTPUT\WINDOWS\SYSTEM
MKDIR OUTPUT\WINDOWS\SYSTEM\COLOR
MKDIR OUTPUT\WINDOWS\SYSTEM\IOSBUSYS
MKDIR OUTPUT\WINDOWS\SYSTEM\VMM32
MKDIR OUTPUT\WINDOWS\TEMP
ECHO.
ECHO Copying Files [3/4]
ECHO.
COPY FILESHERE\BOOTLOG.PRV OUTPUT
IF NOT EXIST OUTPUT\BOOTLOG.PRV COPY NUL MISSING\BOOTLOG.DEL
COPY FILESHERE\BOOTLOG.TXT OUTPUT
IF NOT EXIST OUTPUT\BOOTLOG.TXT COPY NUL MISSING\BOOTLOG2.DEL
COPY FILESHERE\DETLOG.TXT OUTPUT
IF NOT EXIST OUTPUT\DETLOG.TXT COPY NUL MISSING\DETLOG.DEL
COPY FILESHERE\LOGO.SYS OUTPUT
IF NOT EXIST OUTPUT\LOGO.SYS COPY NUL MISSING\LOGO.DEL
COPY FILESHERE\MSDOS.--- OUTPUT
IF NOT EXIST OUTPUT\MSDOS.--- COPY NUL MISSING\MSDOS.DEL
COPY FILESHERE\NETLOG.TXT OUTPUT
IF NOT EXIST OUTPUT\NETLOG.TXT COPY NUL MISSING\NETLOG.DEL
COPY FILESHERE\SETUPLOG.TXT OUTPUT
IF NOT EXIST OUTPUT\SETUPLOG.TXT COPY NUL MISSING\SETUPLOG.DEL
COPY FILESHERE\SUHDLOG.DAT OUTPUT
IF NOT EXIST OUTPUT\SUHDLOG.TXT COPY NUL MISSING\SUHDLOG.DEL
COPY FILESHERE\SYSTEM.1ST OUTPUT
IF NOT EXIST OUTPUT\SYSTEM.1ST COPY NUL MISSING\SYSTEM1.DEL
COPY FILESHERE\WINDOWS\FONTS\MARLETT.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\MARLETT.FON COPY NUL MISSING\MARLETT.DEL
COPY FILESHERE\WINDOWS\FONTS\SERIFE.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\SERIFE.FON COPY NUL MISSING\SERIFE.DEL
COPY FILESHERE\WINDOWS\FONTS\SSERIFE.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\SSERIFE.FON COPY NUL MISSING\SSERIFE.DEL
COPY FILESHERE\WINDOWS\FONTS\VGAFIX.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\VGAFIX.FON COPY NUL MISSING\VGAFIX.DEL
COPY FILESHERE\WINDOWS\FONTS\VGAOEM.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\VGAOEM.FON COPY NUL MISSING\VGAOEM.DEL
COPY FILESHERE\WINDOWS\FONTS\VGASYS.FON OUTPUT\WINDOWS\FONTS
IF NOT EXIST OUTPUT\WINDOWS\FONTS\VGASYS.FON COPY NUL MISSING\VGASYS.DEL
COPY FILESHERE\WINDOWS\SYSTEM\IOSUBSYS\BIGMEM.DRV OUTPUT\WINDOWS\SYSTEM\IOSUBSYS
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\IOSUBSYS\BIGMEM.DRV COPY NUL MISSING\BIGMEM.DEL
COPY FILESHERE\WINDOWS\SYSTEM\IOSUBSYS\RMM.PDR OUTPUT\WINDOWS\SYSTEM\IOSUBSYS
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\IOSUBSYS\RMM.PDR COPY NUL MISSING\RMM.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VMM32\DOSNET.VXD OUTPUT\WINDOWS\SYSTEM\VMM32
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VMM32\DOSNET.VXD COPY NUL MISSING\DOSNET.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VMM32\DOSMGR.VXD OUTPUT\WINDOWS\SYSTEM\VMM32
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VMM32\DOSMGR.VXD COPY NUL MISSING\DOSMGR.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VMM32\IFSMGR.VXD OUTPUT\WINDOWS\SYSTEM\VMM32
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VMM32\IFSMGR.VXD COPY NUL MISSING\IFSMGR.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VMM32\IOS.VXD OUTPUT\WINDOWS\SYSTEM\VMM32
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VMM32\IOS.VXD COPY NUL MISSING\IOS.DEL
COPY FILESHERE\WINDOWS\SYSTEM\ADVAPI32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\ADVAPI32.DLL COPY NUL MISSING\ADVAPI32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\COMCTL32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\COMCTL32.DLL COPY NUL MISSING\COMCTL32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\COMDLG32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\COMDLG32.DLL COPY NUL MISSING\COMDLG32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\CP_437.NLS OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\CP_437.NLS COPY NUL MISSING\CP_437.DEL
COPY FILESHERE\WINDOWS\SYSTEM\CP_1252.NLS OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\CP_1252.NLS COPY NUL MISSING\CP_1252.DEL
COPY FILESHERE\WINDOWS\SYSTEM\DDEML.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\DDEML.DLL COPY NUL MISSING\DDEML.DEL
COPY FILESHERE\WINDOWS\SYSTEM\DEVMGR32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\DEVMGR32.DLL COPY NUL MISSING\DEVMGR32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\GDI.EXE OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\GDI.EXE COPY NUL MISSING\GDI.DEL
COPY FILESHERE\WINDOWS\SYSTEM\GDI32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\GDI32.DLL COPY NUL MISSING\GDI32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\KERNEL32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\KERNEL32.DLL COPY NUL MISSING\KERNEL32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\KEYBOARD.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\KEYBOARD.DRV COPY NUL MISSING\KEYBOARD.DEL
COPY FILESHERE\WINDOWS\SYSTEM\KRNL386.EXE OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\KRNL386.EXE COPY NUL MISSING\KRNL386.DEL
COPY FILESHERE\WINDOWS\SYSTEM\LOCALE.NLS OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\LOCALE.NLS COPY NUL MISSING\LOCALE.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MMSOUND.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MMSOUND.DRV COPY NUL MISSING\MMSOUND.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MOUSE.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MOUSE.DRV COPY NUL MISSING\MOUSE.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MPR.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MPR.DLL COPY NUL MISSING\MPR.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MPREXE.EXE OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MPREXE.EXE COPY NUL MISSING\MPREXE.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MPRSERV.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MPRSERV.DLL COPY NUL MISSING\MPRSERV.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MSGSRV32.EXE OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MSGSVR32.EXE COPY NUL MISSING\MSGSRV32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\MSPWL32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\MSPWL32.DLL COPY NUL MISSING\MSPWL32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\NTDLL.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\NTDLL.DLL COPY NUL MISSING\NTDLL.DEL
COPY FILESHERE\WINDOWS\SYSTEM\PIFMGR.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\PIFMGR.DLL COPY NUL MISSING\PIFMGR.DEL
COPY FILESHERE\WINDOWS\SYSTEM\SHELL.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\SHELL.DLL COPY NUL MISSING\SHELL.DEL
COPY FILESHERE\WINDOWS\SYSTEM\SHELL32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\SHELL32.DLL COPY NUL MISSING\SHELL32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\SYSTEM.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\SYSTEM.DRV COPY NUL MISSING\SYSTEM.DEL
COPY FILESHERE\WINDOWS\SYSTEM\UNICODE.NLS OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\UNICODE.NLS COPY NUL MISSING\UNICODE.DEL
COPY FILESHERE\WINDOWS\SYSTEM\USER.EXE OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\USER.EXE COPY NUL MISSING\USER.DEL
COPY FILESHERE\WINDOWS\SYSTEM\USER32.DLL OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\USER32.DLL COPY NUL MISSING\USER32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VGA.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VGA.DRV COPY NUL MISSING\VGA.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VGAFULL.3GR OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VGAFULL.3GR COPY NUL MISSING\VGAFULL.DEL
COPY FILESHERE\WINDOWS\SYSTEM\VMM32.VXD OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\VMM32.VXD COPY NUL MISSING\VMM32.DEL
COPY FILESHERE\WINDOWS\SYSTEM\WINOA386.MOD OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\WINOA386.MOD COPY NUL MISSING\WINOA386.DEL
COPY FILESHERE\WINDOWS\SYSTEM\WINSPOOL.DRV OUTPUT\WINDOWS\SYSTEM
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM\WINSPOOL.DRV COPY NUL MISSING\WINSPOOL.DEL
COPY FILESHERE\WINDOWS\COMMAND.COM OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\COMMAND.COM COPY NUL MISSING\COMMAND.DEL
COPY FILESHERE\WINDOWS\COMMAND.PIF OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\COMMAND.PIF COPY NUL MISSING\PIFCOMM.DEL
COPY FILESHERE\WINDOWS\DOSPRMPT.PIF OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\DOSPRMPT.PIF COPY NUL MISSING\DOSPRMPT.DEL
COPY FILESHERE\WINDOWS\EXITTO~1.PIF OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\EXITTO~1.PIF COPY NUL MISSING\EXITTO~1.DEL
COPY FILESHERE\WINDOWS\EXPLORER.EXE OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\EXPLORER.EXE COPY NUL MISSING\EXPLORER.DEL
COPY FILESHERE\WINDOWS\HIMEM.SYS OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\HIMEM.SYS COPY NUL MISSING\HIMEM.DEL
COPY FILESHERE\WINDOWS\IFSHLP.SYS OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\IFHLP.SYS COPY NUL MISSING\IFSHLP.DEL
COPY FILESHERE\WINDOWS\REGEDIT.EXE OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\REGEDIT.EXE COPY NUL MISSING\REGEDIT.DEL
COPY FILESHERE\WINDOWS\SYSTEM.INI OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\SYSTEM.INI COPY NUL MISSING\SYSTEINI.DEL
COPY FILESHERE\WINDOWS\WIN.COM OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\WIN.COM COPY NUL MISSING\WIN.DEL
COPY FILESHERE\WINDOWS\WIN.INI OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\WIN.INI COPY NUL MISSING\WININI.DEL
COPY FILESHERE\WINDOWS\WIN386.SWP OUTPUT\WINDOWS
IF NOT EXIST OUTPUT\WINDOWS\WIN386.SWP COPY NUL MISSING\WIN386.DEL
ECHO.
ECHO Creating Archive [4/4]
ECHO.
ECHO Function not yet available!
ECHO.
ECHO Setup has finished preparing files
ECHO.
IF NOT EXIST .\MISSING\*.DEL GOTO COMPLETE
IF EXIST .\MISSING\PIFCOMM.DEL GOTO HALFCOMPLETE
IF EXIST .\MISSING\DOSPRMPT.DEL GOTO HALFCOMPLETE
IF EXIST .\MISSING\EXITTO~1.DEL GOTO HALFCOMPLETE
IF EXIST .\MISSING\DOSNET.DEL GOTO HALFCOMPLETE
IF EXIST .\MISSING\DOSMGR.DEL GOTO HALFCOMPLETE
CLS
ECHO ERROR: There are missing files from your Windows 95 installation. Setup cannot continue. See directory 'MISSING' for files missing from the installation. Files with extension '.DEL' means the file is missing from the installation.
ECHO.
DEL OUTPUT\WINDOWS.zip
ECHO * PIFCOMM.DEL  =     COMMAND.PIF
ECHO * EXITTO~1.DEL = Exit to DOS.PIF
ECHO * WININI.DEL   =         WIN.INI
ECHO * SYSTEINI.DEL =      SYSTEM.INI
ECHO * BOOTLOG2.DEL =     BOOTLOG.TXT
ECHO * SYSTEM1.DEL  =      SYSTEM.1ST
GOTO END
:HALFCOMPLETE
ECHO Warning: Some files may be missing! Ignoring this problem.
GOTO COMPLETE
:COMPLETE
ECHO Setup has completed installation. Press any key to copy the zip.
GOTO END
:END
PAUSE >nul
COPY OUTPUT\WINDOWS.zip CDIMAGE\.
EXIT
